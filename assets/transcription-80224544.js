import{L as re,d as oe,c as ae,__tla as le}from"./Loding-6adeec75.js";import{V as de,__tla as ce}from"./VoiceSound-15864c2a.js";import{l as ue}from"./ISO639_1-f5fa8c7e.js";import{I as p,d as r,A as m,s as y,_ as ge,r as f,o as l,c as u,a as n,w as h,f as v,F as L,h as x,v as _,i as j,k as S,n as he,y as fe,t as b,p as pe,j as ke,__tla as we}from"./index-b3b8bc8f.js";import{__tla as me}from"./VoiceOne-4d1cb32d.js";let M,ye=Promise.all([(()=>{try{return le}catch{}})(),(()=>{try{return ce}catch{}})(),(()=>{try{return we}catch{}})(),(()=>{try{return me}catch{}})()]).then(async()=>{const R=p("round",!1,function(e){return r("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[r("circle",{cx:"24",cy:"24",r:"20",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth},null)])}),C=p("sort-two",!0,function(e){return r("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[r("path",{d:"M19 6V42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),r("path",{d:"M7 17.8994L19 5.89941",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),r("path",{d:"M29 42.1006V6.10059",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),r("path",{d:"M29 42.1006L41 30.1006",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),F=p("translation",!0,function(e){return r("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[r("path",{d:"M17 32L19.1875 27M31 32L28.8125 27M19.1875 27L24 16L28.8125 27M19.1875 27H28.8125",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),r("path",{d:"M43.1999 20C41.3468 10.871 33.2758 4 23.5999 4C13.9241 4 5.85308 10.871 4 20L10 18",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),r("path",{d:"M4 28C5.85308 37.129 13.9241 44 23.5999 44C33.2758 44 41.3468 37.129 43.1999 28L38 30",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),D=p("voice",!1,function(e){return r("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[r("rect",{x:"17",y:"4",width:"14",height:"27",rx:"7",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),r("path",{d:"M9 23C9 31.2843 15.7157 38 24 38C32.2843 38 39 31.2843 39 23",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),r("path",{d:"M24 38V44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),z={name:"transcription",data(){return{prompt:"",isLoading:!1,isDragging:!1,isRecording:!1,decoder:new TextDecoder("utf-8"),resultForeign:"",resultMy:"",transcriptionSettings:{},mediaRecorder:null,chunks:[],languageList:ue}},components:{Loding:re,Voice:D,Round:R,SortTwo:C,Translation:F,VoiceSound:de},mounted(){this.transcriptionSettings=this.getSettingsTrans()},methods:{async handleFileSelect(e){if(!e.target)return;this.isLoading=!0,this.resultForeign="",this.resultMy="";const t=e.target.files;if(!t)return;const o=t[0];e.target.value="",this.beforeUploading(o)},async handleDrop(e){if(e.preventDefault(),this.isLoading)return;this.isLoading=!0,this.isDragging=!1,this.resultForeign="",this.resultMy="";const t=e.dataTransfer.files[0];this.beforeUploading(t)},async uploadFile(e){try{const{body:t,status:o}=await oe(e,this.prompt);if(t){const d=t.getReader();let i=await this.readStream(d,o);o===200?this.resultMy=i.text:(this.resultMy=i,m().error("Fail",{position:"top",duration:1e3}))}}catch(t){this.resultMy=t}finally{}},async beforeUploading(e){e&&(await this.uploadFile(e),await this.translate(),this.isLoading=!1)},async readStream(e,t){let o="";for(;;){const{done:d,value:i}=await e.read();if(d)break;const a=this.decoder.decode(i,{stream:!0});if(t!==200)return JSON.parse(a).error.message??a;o=JSON.parse(a)}return o},getSettingsTrans(){return y().getSettings("settings_trans")},async startRecording(){let e=await navigator.mediaDevices.getUserMedia({audio:!0});e&&(this.isRecording=!0,this.chunks=[],this.mediaRecorder=new MediaRecorder(e),this.mediaRecorder.start(),this.mediaRecorder.addEventListener("dataavailable",t=>{if(t.data.size>0){const o=t.data;let d=new File([o],"sound01.wav",{type:"audio/wav"});this.beforeUploading(d)}}))},stopRecording(){try{this.mediaRecorder&&this.mediaRecorder.state==="recording"&&this.mediaRecorder.stop()}catch(e){console.log("stopRecording error",e)}finally{this.isRecording=!1}},async startTranslation(){this.isLoading=!0,await this.translate(),this.$nextTick(()=>{this.isLoading=!1})},contentSelectChange(e,t){y().setSettings(t,JSON.stringify(this.transcriptionSettings))},async translate(){if(this.resultMy==="")return;let e=[];e.push({role:"user",content:"Translate to "+this.transcriptionSettings.toLanguage}),e.push({role:"user",content:this.resultMy});const{body:t,status:o}=await ae(e,!1);if(t){const d=t.getReader();let i=await this.readStream(d,o);o===200?this.resultForeign=i.choices[0].message.content:(this.resultForeign=i,m().error("Fail",{position:"top",duration:1e3}))}}}},g=e=>(pe("data-v-fdadb635"),e=e(),ke(),e),T={class:"w-full overflow-y-auto max-h-screen"},W={class:"h-screen w-full"},V=g(()=>n("div",{class:"sticky top-0 pt-4 w-full h-12 bg-gray-100"},null,-1)),U={class:"w-full flex flex-col justify-center h-3/4"},N={class:"w-full md:w-1/3"},B={for:"language",class:"text-gray-700 mb2 flex items-center"},I=g(()=>n("span",{class:"w-1/4"},"language",-1)),J=["value"],O={class:"flex justify-center"},A={class:"w-full md:w-1/3"},E={for:"language",class:"text-gray-700 mb2 flex items-center"},H=g(()=>n("span",{class:"w-1/4"},"language",-1)),P=["value"],$={class:"w-full"},q={class:"flex flex-row justify-center"},G={class:"w-3/4 hidden sm:block"},K=["disabled"],Q=g(()=>n("p",null,"Drag and drop files here",-1)),X=g(()=>n("p",{class:"text-xs"},"mp3, mp4, mpeg, mpga, m4a, wav, or webm.",-1)),Y=g(()=>n("p",{class:"text-xs text-red-500"},"Caution! \u201Cm4a\u201D has a few errors.",-1)),Z=[Q,X,Y],ee={class:"w-1/4"};function te(e,t,o,d,i,a){const w=f("voice-sound"),ie=f("Loding"),se=f("translation"),ne=f("voice"),k=f("round");return l(),u("div",T,[n("div",W,[V,n("div",U,[n("div",N,[n("label",B,[I,h(n("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.transcriptionSettings.language=s),class:"input w-3/4",onChange:t[1]||(t[1]=s=>a.contentSelectChange(s,"settings_trans"))},[(l(!0),u(L,null,x(i.languageList,(s,c)=>(l(),u("option",{key:c,value:c},b(c+" "+s.nativeName),9,J))),128))],544),[[v,i.transcriptionSettings.language]]),h(r(w,{content:i.resultMy},null,8,["content"]),[[_,!i.isLoading]])])]),h(n("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.resultMy=s),class:"input w-full text-justify whitespace-pre-line",placeholder:"Audio Content"},null,512),[[j,i.resultMy]]),n("p",O,[i.isLoading?(l(),S(ie,{key:0,class:"mt-1"})):(l(),S(se,{key:1,class:"w-10",theme:"outline",size:"24",fill:"#333",onClick:t[3]||(t[3]=s=>a.startTranslation())}))]),n("div",A,[n("label",E,[H,h(n("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>i.transcriptionSettings.toLanguage=s),class:"input w-3/4",onChange:t[5]||(t[5]=s=>a.contentSelectChange(s,"settings_trans"))},[(l(!0),u(L,null,x(i.languageList,(s,c)=>(l(),u("option",{key:c,value:c},b(c+" "+s.nativeName),9,P))),128))],544),[[v,i.transcriptionSettings.toLanguage]]),h(r(w,{content:i.resultForeign},null,8,["content"]),[[_,!i.isLoading]])])]),h(n("textarea",{disabled:"","onUpdate:modelValue":t[6]||(t[6]=s=>i.resultForeign=s),class:"input w-full text-justify whitespace-pre-line",placeholder:"Translate Content"},null,512),[[j,i.resultForeign]])]),n("div",$,[n("div",q,[n("div",G,[n("input",{type:"file",acept:"audio/*",ref:"fileInput",onChange:t[7]||(t[7]=(...s)=>a.handleFileSelect&&a.handleFileSelect(...s)),disabled:i.isLoading||i.isRecording},null,40,K),n("div",{class:he(["border border-dashed border-blue-500 text-center",{dragging:i.isDragging}]),onDragover:t[8]||(t[8]=fe(()=>{},["prevent"])),onDrop:t[9]||(t[9]=(...s)=>a.handleDrop&&a.handleDrop(...s)),onDragenter:t[10]||(t[10]=s=>i.isDragging=!0),onDragleave:t[11]||(t[11]=s=>i.isDragging=!1)},Z,34)]),n("div",ee,[i.isRecording?(l(),u("div",{key:1,class:"loading",onClick:t[13]||(t[13]=s=>a.stopRecording())},[r(k,{theme:"multi-color",size:"100",fill:["#f5a623","#ff0000","#ffffff","#417505"]}),r(k,{theme:"multi-color",size:"100",fill:["#ffffff","#ff0000","#ffffff","#417505"]}),r(k,{theme:"multi-color",size:"100",fill:["#bd10e0","#ff0000","#ffffff","#417505"]})])):(l(),u("div",{key:0,onClick:t[12]||(t[12]=s=>a.startRecording())},[r(ne,{theme:"outline",size:"100",fill:"#333",class:"hover:cursor-pointer"})]))])])])])])}M=ge(z,[["render",te],["__scopeId","data-v-fdadb635"]])});export{ye as __tla,M as default};
